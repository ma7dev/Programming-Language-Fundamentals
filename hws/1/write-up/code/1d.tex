\begin{lstlisting}[language=haskell]
subbag :: Eq a => Bag a -> Bag a -> Bool
subbag [] [] = True
subbag ((value, counter):tail) [] = False
subbag [] set = True
subbag ((value, counter):tail) set = 
    if del value set == set then do False
    else do
        if counter == 1 then do subbag tail set
        else do subbag ([(value, counter-1)] ++ tail) (del value set)
\end{lstlisting}